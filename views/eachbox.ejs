<!DOCTYPE html>
<html>
  <head>
    <% include ../views/partials/head %>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.3/socket.io.slim.js"></script>
    
  </head>
  <body>
    <% include ../views/partials/nav %>
    
    <div class="container" id="admin_container">

    <div class="row">
    	<div class="col-lg-12">
    		<div class="page-header">
          <h1 >Box <%= box.box_id %></h1>
        </div>

        <div class="well well-lg">
          User ID : <%= box.user_id %><br>
          LED(out) : <%= box.led_out %><br>
          LED(in) : <%= box.led_in %><br>
          Photosensor : <%= box.photosen %><br>
          Microswitch : <%= box.micros %><br>
          Lock : <p id="lock_status"><%= box.lock %></p>


          <button type="submit" class="btn btn-default" id="lock_but">lock</button>
          <button type="submit" class="btn btn-default" id="photo_but">photo</button>

        </div>

            
      </div>
    </div>

    </div>
  </body>
  <script>
    var socket = io();

    $("#photo_but").click(function(){
      var photo_info = {id:'<%= box._id %>', user_id:'<%= box.user_id =%>', box_id:'<%= box.box_id %>'}
      socket.emit('photo', photo_info);
      socket.on('photo', function(msg){
        //$('#lock_status').html(msg.lock);
        //location.reload();
      });
    });

    $("#lock_but").click(function(){
      var lock_info = {lock:<%= box.lock %>, id:'<%= box._id %>'}
      socket.emit('lock', lock_info);
      socket.on('lock', function(msg){
        $('#lock_status').html(msg.lock);
        location.reload();
      });


          /*  $.post(
             '/admin',
             {lock:<%= box.lock %>, id:'<%= box._id %>'},
             function(data) {
              $('#lock_status').html(data.lock);
            },
             'json'
            );*/

    });
  </script>
</html>
